<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>چک‌لیست روزانه تریدر</title>
<style>
  :root { --card:#ffffff; --bg:#f5f5f7; --text:#1a1a1a; --muted:#666; --accent:#0d6efd; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:Tahoma,Arial,"Segoe UI",sans-serif;color:var(--text);}
  .container{max-width:820px;margin:24px auto;padding:16px;}
  .card{background:var(--card);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.06);padding:20px;margin-bottom:16px;}
  h1{font-size:22px;margin:0 0 12px 0}
  h2{font-size:18px;margin:18px 0 8px 0}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .controls button{border:0;border-radius:10px;padding:10px 14px;background:#eee;cursor:pointer}
  .controls button.primary{background:var(--accent);color:#fff}
  .controls{display:flex;gap:8px;flex-wrap:wrap}
  .muted{color:var(--muted);font-size:13px}
  .section{padding:12px 0;border-top:1px dashed #e6e6e9}
  .todo{display:flex;align-items:flex-start;gap:10px;padding:10px;border-radius:10px}
  .todo:hover{background:#fafafa}
  input[type="checkbox"]{width:18px;height:18px;margin-top:2px}
  .progress{height:10px;background:#e9ecef;border-radius:999px;overflow:hidden}
  .bar{height:100%;width:0;background:var(--accent);transition:width .25s ease}
  .footer{font-size:12px;color:var(--muted);text-align:center;margin-top:10px}
  .datebox{padding:8px 10px;border:1px solid #e6e6ea;border-radius:10px;background:#fff}
</style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>✅ چک‌لیست روزانه تریدر</h1>
      <div class="row" style="justify-content:space-between">
        <div class="row">
          <label class="muted">تاریخ:</label>
          <input id="date" type="date" class="datebox">
        </div>
        <div class="controls">
          <button id="reset">پاک‌کردن تیک‌ها</button>
          <button id="share" class="primary">اشتراک‌گذاری وضعیت</button>
        </div>
      </div>
      <div style="margin:12px 0 6px 0" class="muted">پیشرفت امروز</div>
      <div class="progress"><div id="bar" class="bar"></div></div>
      <div id="ratio" class="muted" style="margin-top:6px">۰٪ کامل</div>
    </div>

    <div id="list" class="card"></div>

    <div class="footer">این فایل آفلاین کار می‌کند و تیک‌ها در حافظه مرورگر ذخیره می‌شوند.</div>
  </div>

<script>
const data = [
  { title:"بخش ۱: آماده‌سازی قبل از شروع بازار", items:[
    "خواب و استراحت کافی داشتم؟ (۷–۸ ساعت)",
    "ذهن آرام و بدون استرس هستم؟",
    "خبرهای اقتصادی و فاندامنتال مهم امروز را چک کردم",
    "محیط کارم خلوت و بدون حواس‌پرتی است"
  ]},
  { title:"بخش ۲: تحلیل بازار", items:[
    "روند کلی بازار را روی تایم‌فریم بالا مشخص کردم",
    "سطوح حمایت/مقاومت و محدوده‌های کلیدی مشخص است",
    "استراتژی من سیگنال واضحی داده (حدس نزدم)",
    "نسبت ریسک به ریوارد حداقل ۱:۲ است"
  ]},
  { title:"بخش ۳: مدیریت ریسک", items:[
    "حجم معامله کمتر از ۱–۲٪ حساب است",
    "استاپ‌لاس مشخص و ثبت شده",
    "تارگت یا پلن خروج مشخص است",
    "اگر استاپ بخورد، معامله انتقامی نمی‌زنم"
  ]},
  { title:"بخش ۴: حین معامله", items:[
    "معامله مطابق پلن است، نه احساس",
    "بیش از ۲ معامله در روز باز نکردم (Overtrading ندارم)",
    "موقعیت را مانیتور می‌کنم اما درگیر هیجان نمی‌شوم"
  ]},
  { title:"بخش ۵: بعد از معامله", items:[
    "نتیجه معامله (سود/ضرر) را در ژورنال ثبت کردم",
    "دلیل ورود، خروج و احساساتم را یادداشت کردم",
    "پایبندی به قوانین خودم را ارزیابی کردم"
  ]}
];

const elList = document.getElementById("list");
const elDate = document.getElementById("date");
const elBar = document.getElementById("bar");
const elRatio = document.getElementById("ratio");
const btnReset = document.getElementById("reset");
const btnShare = document.getElementById("share");

function storageKey() {
  return "trading_checklist_" + (elDate.value || new Date().toISOString().slice(0,10));
}

function render() {
  elList.innerHTML = "";
  data.forEach((sec, sIdx) => {
    const secDiv = document.createElement("div");
    secDiv.className = "section";
    const h = document.createElement("h2"); h.textContent = sec.title; secDiv.appendChild(h);
    sec.items.forEach((txt, iIdx) => {
      const row = document.createElement("label"); row.className = "todo";
      const cb = document.createElement("input"); cb.type = "checkbox";
      cb.dataset.key = `${sIdx}-${iIdx}`;
      const span = document.createElement("span"); span.textContent = txt;
      row.appendChild(cb); row.appendChild(span); secDiv.appendChild(row);
    });
    elList.appendChild(secDiv);
  });
  restoreState(); updateProgress();
}

function saveState() {
  const state = {};
  document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    state[cb.dataset.key] = cb.checked ? 1 : 0;
  });
  localStorage.setItem(storageKey(), JSON.stringify(state));
  updateProgress();
}

function restoreState() {
  const raw = localStorage.getItem(storageKey());
  const state = raw ? JSON.parse(raw) : {};
  document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    cb.checked = !!state[cb.dataset.key];
    cb.addEventListener("change", saveState);
  });
}

function updateProgress() {
  const cbs = Array.from(document.querySelectorAll('input[type="checkbox"]'));
  const total = cbs.length;
  const done = cbs.filter(cb => cb.checked).length;
  const pct = total ? Math.round((done/total)*100) : 0;
  elBar.style.width = pct + "%";
  elRatio.textContent = pct + "٪ کامل";
}

btnReset.addEventListener("click", () => {
  document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
  saveState();
});

btnShare.addEventListener("click", async () => {
  const cbs = Array.from(document.querySelectorAll('input[type="checkbox"]'));
  const total = cbs.length;
  const done = cbs.filter(cb => cb.checked).length;
  const pct = total ? Math.round((done/total)*100) : 0;
  const txt = `چک‌لیست روزانه تریدر (${elDate.value || new Date().toISOString().slice(0,10)}): ${pct}% کامل`;
  if (navigator.share) {
    try { await navigator.share({ text: txt, title: "چک‌لیست تریدر" }); } catch(e){}
  } else {
    navigator.clipboard.writeText(txt);
    alert("درصد پیشرفت در کلیپ‌بورد کپی شد ✅");
  }
});

// پیش‌فرض: امروز
elDate.value = new Date().toISOString().slice(0,10);
elDate.addEventListener("change", render);

render();
</script>
</body>
</html>
